#!/usr/bin/make -f
include /usr/share/dpkg/default.mk

# 有的Qt5环境需要设置环境变量，Qt6不需要
export QT_SELECT=5

# 检测当前安装的Qt版本，优先使用Qt6，否则使用Qt5
define detect_qt_version
ifneq (,$(shell which qmake6 2>/dev/null))
    QMAKE=qmake6
else
    QMAKE=qmake
endif
endef

# 调用检测Qt版本的命令
$(eval $(call detect_qt_version))

# hardcode this if want to force build with sepecific Qt version
# QMAKE=qmake

%:
	dh $@ --parallel --buildsystem=qmake

override_dh_auto_configure:
	$(QMAKE) \
		PREFIX=/usr \
		LIB_INSTALL_DIR=/usr/lib/$(DEB_HOST_MULTIARCH) \
		VERSION_UPSTREAM=$(DEB_VERSION_UPSTREAM) \
		DEFINES+="VERSION=$(DEB_VERSION_UPSTREAM)" \
		CONFIG+=release